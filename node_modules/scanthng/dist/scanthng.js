var ScanThng;(()=>{var e={54:e=>{e.exports={convertImage:function(e,t){var r=t.imageConversion;return new Promise((function(t){var n=document.createElement("canvas"),o=e.width,i=e.height,a={width:o,height:i},c=r.resizeTo,s=r.greyscale;if(!1!==c){var u=Math.max(c,144),d=e.width/e.height,l=u/Math.min(e.width,e.height);o=d>1?e.width*l:u,i=d>1?u:e.height*l}n.width=o,n.height=i;var p=n.getContext("2d");p.imageSmoothingEnabled=!1,p.drawImage(e,0,0,a.width,a.height,0,0,n.width,n.height),s&&function(e){var t=e.getContext("2d");t.imageSmoothingEnabled=!1;for(var r=t.getImageData(0,0,e.width,e.height),n=r.data,o=0;o<n.length;o+=4){var i=.3*n[o]+.59*n[o+1]+.11*n[o+2];n[o]=i,n[o+1]=i,n[o+2]=i}t.putImageData(r,0,0)}(n),t(n)}))}}},352:(e,t,r)=>{function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var c=r(648),s=r(186),u=r(745),d={invisible:!0,imageConversion:{greyscale:!0,resizeTo:1e3,exportQuality:.9},createAnonymousUser:!1},l=function(e){var t=i(i({},d),e);return t.imageConversion=i(i({},d.imageConversion),e?e.imageConversion:{}),e&&e.imageConversion&&e.imageConversion.resizeTo&&(t.imageConversion.resizeTo=Math.max(t.imageConversion.resizeTo,e.imageConversion.resizeTo)),t},p=function(e,t,r){return function(e,t){if(!t||!t.createAnonymousUser)return Promise.resolve();if(!e.appUser)throw new Error("createAnonymousUser only available with Application Scope type");var r=c.restoreUser(e,evrythng.User);return"object"===n(r)?Promise.resolve(r):e.appUser().create({anonymous:!0}).then((function(t){return c.storeUser(e,t),t}))}(e,r).then((function(e){return t.map((function(t){return i(i({},t),{},{user:e})}))}))},f=function(e,t,r){var o={};["debug","perPage","filter"].forEach((function(e){t[e]&&(o[e]=t[e])})),"object"===n(o.filter)&&(o.filter=function(e){return Object.entries(e).map((function(e){return"".concat(e[0],"=").concat(e[1])})).join("&")}(o.filter));var i={url:"/scan/identifications",method:r?"post":"get",apiKey:e.apiKey,params:o};return r&&(i.body=JSON.stringify(r)),evrythng.api(i).then((function(r){return p(e,r,t)}))},g=function(e,t,r){var n=[{results:[],meta:{value:r}}];if(t.offline)return n;if("string"==typeof r){var o=i(i({},t),{},{filter:"type=".concat(t.filter.type,"&value=").concat(r)});return e.identify(o).catch((function(e){return console.log("Identification failed, falling back to meta-only response"),console.log(e),n}))}return r};function m(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.filter;if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)return console.log("getUserMedia() is not supported with this browser; falling back to Media Capture."),this.scan(e);if(!t||!t.method||!t.type)throw new Error("Please provide valid filter");var r=this;return u.scanCode(e,r).then((function(t){return g(r,e,t)})).then((function(e){return p(r,e)}))}var h=function(e){window.location.href=e};function v(e){if("object"!==n(e)||!e.filter)throw new Error("Missing filter option.");return f(this,l(e))}function y(e,t){var r,n={};e&&(t?(r=e,n=t):"string"==typeof e?r=e:n=e);var o={invisible:n.invisible,imageConversion:n.imageConversion},i="string"==typeof r?s.processImage(r,o):s.getFile(o).then((function(e){return s.processImage(e,o)})),a=this;return i.then((function(e){return f(a,l(n),e)}))}var w={install:function(e){e.scopes.Application.prototype.redirect=h,e.scopes.Application.prototype.identify=v,e.scopes.Application.prototype.scanStream=m,e.scopes.Application.prototype.stopStream=u.stop,e.scopes.Application.prototype.scan=y,e.scopes.Application.prototype.setTorchEnabled=u.setTorchEnabled,e.scopes.AccessToken&&(e.scopes.AccessToken.prototype.redirect=h,e.scopes.AccessToken.prototype.identify=v,e.scopes.AccessToken.prototype.scanStream=m,e.scopes.AccessToken.prototype.stopStream=u.stop,e.scopes.AccessToken.prototype.scan=y,e.scopes.AccessToken.prototype.setTorchEnabled=u.setTorchEnabled),e.scopes.Operator.prototype.redirect=h,e.scopes.Operator.prototype.identify=v,e.scopes.Operator.prototype.scanStream=m,e.scopes.Operator.prototype.stopStream=u.stop,e.scopes.Operator.prototype.scan=y,e.scopes.Operator.prototype.setTorchEnabled=u.setTorchEnabled},convertImageFormat:s.processImage,convertToDataUrl:s.readUserFile,scanQrCode:function(e,t){return u.scanCode(i({containerId:e,filter:{method:"2d",type:"qr_code"}},t))},stopScanQrCode:u.stop};e.exports=w},186:(e,t,r)=>{function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var c,s,u={invisible:!0,imageConversion:{greyscale:!0,resizeTo:480,exportFormat:"image/png",exportQuality:.9}},d="scanthng_form",l=function(e){return new Promise((function(t,r){e.addEventListener("change",(function(e){var n,o,i=(n=e.target.files,o=1,function(e){if(Array.isArray(e))return e}(n)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i=[],a=!0,c=!1;try{for(r=r.call(e);!(a=(n=r.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){c=!0,o=e}finally{try{a||null==r.return||r.return()}finally{if(c)throw o}}return i}}(n,o)||function(e,t){if(e){if("string"==typeof e)return a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(e,t):void 0}}(n,o)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0];i?t(i):r(new Error("No file selected."))})),e.click()}))},p=function(e){return new Promise((function(t,r){var n=new FileReader;n.onload=function(e){return t(e.target.result)},n.onerror=r,n.readAsDataURL(e)}))},f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{invisible:e.invisible?e.invisible:u.invisible,imageConversion:o(o({},u.imageConversion),e.imageConversion)}};c=r(54),s=r(648),e.exports={DEFAULT_OPTIONS:u,getFile:function(e){return(t=f(e),new Promise((function(e){!function(){for(var e=document.getElementsByClassName(d),t=0;t<e.length;t+=1)e[t].parentElement&&e[t].parentElement.removeChild(e[t])}();var r=document.createElement("form");r.setAttribute("id","scanthng".concat(Date.now())),r.setAttribute("class",d),r.style.visibility=t.invisible?"hidden":"initial";var n=document.createElement("input");n.setAttribute("type","file"),n.setAttribute("name","scanThng_upload"),n.setAttribute("accept","image/*"),n.setAttribute("capture","camera"),r.appendChild(n),document.body.appendChild(r),e(n)}))).then(l).then(p);var t},processImage:function(e,t){if(!s.isDataUrl(e))throw new Error("Invalid Image Data URL.");var r,n=f(t);return(r=e,new Promise((function(e,t){var n=document.createElement("img");n.onload=function(){"naturalHeight"in this&&this.naturalHeight+this.naturalWidth===0?this.onerror():this.width+this.height!==0?e(n):this.onerror()},n.onerror=function(){return t(new Error("Invalid image"))},n.src=r}))).then((function(e){return c.convertImage(e,n)})).then((function(e){return function(e,t){var r=t.imageConversion;return e.toDataURL(r.exportFormat,r.exportQuality)}(e,n)})).then((function(e){return{image:e}}))},readUserFile:p}},745:(e,t,r)=>{var n,o,i,a,c,s,u,d,l,p=r(648),f=r(186),g={exportFormat:"image/jpeg",greyscale:!1,resizeTo:1080,exportQuality:.85,cropPercent:.1},m=!1,h=0,v=!1,y=function(){try{var e=a,t=e.width,r=e.height,n=a.getContext("2d");return n.imageSmoothingEnabled=!1,n.getImageData(0,0,t,r)}catch(e){console.log("Failed to getImageData - device may not be ready.")}},w=function(e,t){return t.downloadFrames&&p.promptImageDownload(e),m=!0,n.scan(e,t).then((function(e){return m=!1,e.length?e:void 0})).catch((function(e){if(m=!1,!e.errors||!e.errors[0].includes("lacking sufficient detail"))throw e}))},b=function(e){var t=e.exportFormat,r=e.exportQuality;return a.toDataURL(t,r)},E=function(){v=!1,clearTimeout(l),i.getVideoTracks()[0].stop(),i=null,o.parentElement.removeChild(o)};function O(e,t,r){v&&(l=setTimeout((function(){return function(e,t,r){var i=e.autoStop,l=e.onScanFrameData,f=e.imageConversion,g=e.onScanValue;try{return m?void O(e,t,r):function(e){return new Promise((function(t){if(0===o.videoWidth||0===o.videoHeight)return t();var r;(r=a.getContext("2d")).imageSmoothingEnabled=!1,a.width=o.videoWidth,a.height=o.videoHeight,r.drawImage(o,0,0);var i=e.filter,l=i.method,f=i.type,g=e.useDiscover,m=void 0!==g&&g,h=e.onWatermarkDetected,v=e.imageConversion,E=void 0===v?{}:v,O=E.cropPercent,S=void 0===O?0:O;if("2d"===l&&"qr_code"===f){var D=function(){var e=a,t=e.width,r=e.height,n=y();if(n)return window.jsQR(n.data,t,r)}();return D?t(D.data):t()}if("1d"===l&&window.ZXingBrowser){var C=function(){try{var e=u.decodeFromCanvas(a),t=p.getZxingBarcodeFormatType(e.getBarcodeFormat());return{text:e.text,formatType:t}}catch(e){return}}();return C?(e.filter.type=C.formatType,t(C.text)):t()}if("2d"===l&&"dm"===f&&window.ZXingBrowser){var I=function(){try{return{text:d.decodeFromCanvas(a).text,formatType:"dm"}}catch(e){return}}();return I?(e.filter.type=I.formatType,t(I.text)):t()}if(!n)return t();S&&function(e){var t=p.getCropDimensions(a,e),r=t.x,n=t.y,o=t.width,i=t.height,c=document.createElement("canvas");c.width=o,c.height=i;var s=c.getContext("2d");s.imageSmoothingEnabled=!1,s.drawImage(a,r,n,o,i,0,0,o,i),a.width=o,a.height=i;var u=a.getContext("2d");u.imageSmoothingEnabled=!1,u.drawImage(c,0,0)}(S);var x,T=b(E);return"digimarc"===l&&m?(x=T,new Promise((function(e){c||(c=new Image),c.src=null,c.onload=function(){var t=a.getContext("2d");t.imageSmoothingEnabled=!1,t.drawImage(c,0,0),e()},c.src=x}))).then((function(){var r=y(),n=r.width,o=r.height,i=r.data,a=s.detect(i,n,o);return h&&h(a),a.watermark?w(T,e).then(t):t()})):w(T,e).then(t)}))}(e).then((function(n){if(n){if(i)return E(),l&&l(b(f)),void t(n);var o=Date.now();o-h>500&&(h=o,l&&l(b(f)),g(n),O(e,t,r))}else O(e,t,r)}))}catch(e){return console.log(e),void r(e)}}(e,t,r)}),500))}e.exports={scanCode:function(e,t){n=t;var r=e.containerId,c=e.idealWidth,l=void 0===c?1920:c,m=e.idealHeight,h=void 0===m?1080:m;if(!document.getElementById(r))throw new Error("Please specify 'containerId' where the video element can be added as a child");return navigator.mediaDevices.enumerateDevices().then((function(e){return e.filter((function(e){return"videoinput"===e.kind}))})).then((function(e){var t=p.isAndroidDevice()&&e.length>0?e[e.length-1].deviceId:void 0;return navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",deviceId:t,width:{ideal:l},height:{ideal:h}}})})).then((function(t){return i=t,p.insertVideoElement(r),v=!0,function(e){a||(a=document.createElement("canvas")),(o=document.getElementById(p.VIDEO_ELEMENT_ID)).srcObject=i,o.play(),void 0===e.autoStop&&(e.autoStop=!0),void 0===e.useDiscover&&(e.useDiscover=!1),void 0===e.useZxing&&(e.useZxing=!1);var t=e.filter,r=t.method,c=t.type,l=e.autoStop,m=e.imageConversion,h=e.useDiscover,v=e.onScanValue,y="digimarc"===r&&h,w="2d"===r&&"qr_code"===c,b="1d"===r||"2d"===r&&"dm"===c,E=w||b;if(w&&!window.jsQR)throw new Error("jsQR (https://github.com/cozmo/jsQR) not found. You must include it in a <script> tag.");if(y&&!s){if(!window.DigimarcDetector)throw new Error("discover.js not found. You must include it (and associated WASM/wrapper) in a <script> tag");s=new window.DigimarcDetector}if(b&&!u){if(!window.ZXingBrowser)throw new Error("zxing-js/browser not found. You must include it in a <script> tag");u=new window.ZXingBrowser.BrowserMultiFormatOneDReader,d=new window.ZXingBrowser.BrowserDatamatrixCodeReader}if(!n&&!E)throw new Error("Non-local code scanning requires specifying an Application or Operator scope for API access");if(!l&&!v)throw new Error("onScanValue is required to get results when autoStop is disabled");return y&&!m?(console.log("Selecting optimal digimarc imageConversion: ".concat(JSON.stringify(g))),e.imageConversion=g):e.imageConversion=m||f.DEFAULT_OPTIONS.imageConversion,new Promise((function(t,r){return O(e,t,r)}))}(e)}))},stop:E,setTorchEnabled:function(e){if(!i)throw new Error("Stream not ready, torch cannot be enabled");var t=i.getVideoTracks()[0];if(!t.getCapabilities().torch)throw new Error("Device does not support the torch capability");t.applyConstraints({advanced:[{torch:e}]}).catch((function(e){return console.log(e)}))}}},648:e=>{var t="scanthng-video-".concat(Date.now()),r=function(e,t){localStorage.setItem(e,JSON.stringify(t))},n=function(e){return JSON.parse(localStorage.getItem(e))};e.exports={VIDEO_ELEMENT_ID:t,isDataUrl:function(e){return"string"==typeof e&&e.match(/^\s*data:image\/(\w+)(;charset=[\w-]+)?(;base64)?,/)},writeStorage:r,readStorage:n,restoreUser:function(e,t){if(!localStorage)throw new Error("Cannot restore user, localStorage is not available");var r=n("scanthng-".concat(e.id));if(r&&r.apiKey)return new t(r.apiKey)},storeUser:function(e,t){var n={apiKey:t.apiKey},o="scanthng-".concat(e.id);if("undefined"==typeof localStorage)throw new Error("Failed to write user to LocalStorage");r(o,n)},insertVideoElement:function(e){if(!document.getElementById(t)){var r=document.createElement("video");r.id=t,r.autoPlay=!0,r.playsInline=!0,document.getElementById(e).appendChild(r)}},isAndroidDevice:function(){return navigator.userAgent&&navigator.userAgent.includes("Android")},promptImageDownload:function(e){var t=e.split("/")[1].split(";")[0],r=document.createElement("a");r.download="frame.".concat(t),r.href=e,r.click()},getCropDimensions:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if("number"!=typeof t||t<0||t>.9)throw new Error("cropPercent option must be between 0 and 0.9");var r=0,n=0,o=e.width,i=e.height;if(0===t)return{x:r,y:n,width:o,height:i};var a=i>o;a?(n=(i-o)/2,i=o):(r=(o-i)/2,o=i);var c=a?t*o:t*i;return r+=c,n+=c,o-=c,i-=c,{x:Math.round(r),y:Math.round(n),width:Math.round(o),height:Math.round(i)}},getZxingBarcodeFormatType:function(e){var t={0:null,1:"codabar",2:"code_39",3:"code_93",4:"code_128",5:"dm",6:"ean_8",7:"ean_13",8:"itf",9:null,10:null,11:null,12:"rss_14",13:"rss_expanded",14:"upc_a",15:"upc_e",16:null};if(!t[e])throw new Error("Type returned by zxing-js/browser not supported by ID API: ".concat(e));return t[e]}}}},t={},r=function r(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,r),i.exports}(352);ScanThng=r})();